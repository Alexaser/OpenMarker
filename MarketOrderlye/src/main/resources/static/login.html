<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Ö–æ–¥</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        form { max-width: 300px; margin: auto; }
        input, button { width: 100%; margin: 8px 0; padding: 10px; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>

<h2>–í—Ö–æ–¥</h2>

<form id="loginForm">
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
    <button type="submit">–í–æ–π—Ç–∏</button>
</form>

<p id="message"></p>

<script>
    document.getElementById("loginForm").addEventListener("submit", async function(event) {
        event.preventDefault(); // üî• –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const messageElement = document.getElementById("message");

        try {
            const response = await fetch("http://localhost:8080/auth/login", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ email, password })
            });

            const data = await response.text(); // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–ª–∏ –æ—à–∏–±–∫—É

            if (response.ok) {
                localStorage.setItem("token", data); // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –≤ localStorage
                messageElement.innerHTML = "‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!";
                messageElement.className = "success";
                setTimeout(() => window.location.href = "/profile.html", 1000); // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å
            } else {
                messageElement.innerHTML = "‚ùå " + data;
                messageElement.className = "error";
            }

        } catch (error) {
            messageElement.innerHTML = "‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º!";
            messageElement.className = "error";
        }
    });
</script>

</body>
</html>